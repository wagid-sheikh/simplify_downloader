{"run_id": "20260105_110335387553", "phase": "init", "status": "ok", "message": "Starting TD orders sync discovery flow", "run_env": "dev", "from_date": "2025-12-06", "to_date": "2026-01-05", "ts": "2026-01-05T11:03:35.391137+00:00"}
{"run_id": "20260105_110335387553", "phase": "init", "status": "warn", "message": "Temporarily restricting TD orders discovery to a subset of stores", "stores": ["A668", "A817"], "skipped_stores": null, "ts": "2026-01-05T11:03:35.449422+00:00"}
{"run_id": "20260105_110335387553", "phase": "init", "status": "ok", "message": "Loaded TD store rows", "store_count": 2, "stores": ["A668", "A817"], "ts": "2026-01-05T11:03:35.449536+00:00"}
{"run_id": "20260105_110335387553", "phase": "init", "status": "ok", "message": "Launching Playwright with local Chrome executable", "backend": "local_chrome", "executable_path": "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome", "headless": false, "ts": "2026-01-05T11:03:36.544753+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "store", "status": "ok", "message": "Starting TD orders store discovery", "run_env": "dev", "from_date": "2025-12-06", "to_date": "2026-01-05", "ts": "2026-01-05T11:03:37.461321+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "session", "status": "ok", "message": "Storage state found; probing session validity", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A668_storage_state.json", "ts": "2026-01-05T11:03:38.308046+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "session", "status": "warn", "message": "Probed session with existing storage state", "response_status": 200, "final_url": "https://subs.quickdrycleaning.com/Login", "contains_store_code": false, "verification_seen": false, "login_detected": true, "nav_visible": false, "home_card_visible": false, "state_valid": false, "invalid_reason": "login_form_visible", "probe_error": null, "probe_target": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "contains_store_path": false, "ts": "2026-01-05T11:03:43.903924+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "session", "status": "ok", "message": "Storage state probe invalid; performing login", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A668_storage_state.json", "probe_reason": "login_form_visible", "probe_valid": false, "verification_seen": false, "nav_visible": false, "home_card_visible": false, "re_login_performed": true, "ts": "2026-01-05T11:03:43.904135+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "login", "status": "ok", "message": "Completed login attempt", "final_url": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "contains_store_code": true, "post_login_wait_completed": "url_contains_store_code", "post_login_wait_error": null, "submit_error": null, "selectors": {"username": "#txtUserId", "password": "#txtPassword", "store_code": "#txtBranchPin", "submit": "#btnLogin"}, "ts": "2026-01-05T11:03:45.142496+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "session", "status": "ok", "message": "Login completed; session ready", "final_url": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A668_storage_state.json", "probe_reason": "login_form_visible", "probe_valid": false, "login_performed": true, "re_login_performed": true, "ts": "2026-01-05T11:03:45.142834+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "session", "status": "ok", "message": "Session ready after OTP/verification wait", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A668_storage_state.json", "final_url": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "verification_seen": false, "login_performed": true, "ts": "2026-01-05T11:03:45.143012+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "login", "status": "ok", "message": "Home page ready after login/verification", "final_url": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "nav_selector": "#achrOrderReport", "nav_visible": true, "home_card_visible": false, "ts": "2026-01-05T11:03:46.434505+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "home", "status": "ok", "message": "Navigation controls snapshot", "links": [{"index": 0, "text": "Home    \n(Ctrl+H)", "href": "home.html?ClearContent=1-0-2026 16:33:46", "visible": true}, {"index": 1, "text": "Dashboard", "href": "Bookings_New/frmDashBoard.aspx?ClearContent=1-0-2026 16:33:46", "visible": false}, {"index": 2, "text": "Customer", "href": "New_Admin/frmNewCustomer.aspx?ClearContent=1-0-2026 16:33:46", "visible": true}, {"index": 3, "text": "Drop (F1)", "href": "", "visible": false}, {"index": 4, "text": "Reports", "href": "Reports/OrderReport.aspx?ClearContent=1-0-2026 16:33:46", "visible": true}], "ts": "2026-01-05T11:03:46.545840+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "session", "status": "ok", "message": "Stored refreshed session state after home detection", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A668_storage_state.json", "verification_seen": false, "ts": "2026-01-05T11:03:46.556984+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "orders", "status": "ok", "message": "Skipping Orders iframe flow because Orders segment was disabled by flag", "ts": "2026-01-05T11:03:46.557079+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Starting Sales navigation via direct URL", "navigation_method": "direct", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "ts": "2026-01-05T11:03:46.557592+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Waiting for Sales URL match after direct navigation", "navigation_method": "direct", "target_pattern": "/A668/App/Reports/NEWSalesAndDeliveryReport", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "ts": "2026-01-05T11:03:46.709376+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "warn", "message": "Sales destination validation failed after direct navigation", "navigation_method": "direct", "final_url": "https://subs.quickdrycleaning.com/Login", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "contains_store_code": false, "contains_sales_path": false, "is_login_url": true, "ts": "2026-01-05T11:05:16.722584+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Sales navigation attempt", "navigation_method": "direct", "attempt": "initial", "retry_status": "initial", "success": false, "final_url": "https://subs.quickdrycleaning.com/Login", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "login_redirect", "ts": "2026-01-05T11:05:16.723685+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "login", "status": "ok", "message": "Completed login attempt", "final_url": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "contains_store_code": true, "post_login_wait_completed": "url_contains_store_code", "post_login_wait_error": null, "submit_error": null, "selectors": {"username": "#txtUserId", "password": "#txtPassword", "store_code": "#txtBranchPin", "submit": "#btnLogin"}, "ts": "2026-01-05T11:05:17.598252+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "login", "status": "ok", "message": "Home page ready after login/verification", "final_url": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "nav_selector": "#achrOrderReport", "nav_visible": true, "home_card_visible": false, "ts": "2026-01-05T11:05:20.054381+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Refreshed storage state after Sales re-login", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A668_storage_state.json", "final_url": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "ts": "2026-01-05T11:05:20.066670+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Retrying Sales navigation via Reports after login redirect or validation failure", "retry_status": "after_login", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "last_reason": "login_redirect", "ts": "2026-01-05T11:05:20.066800+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Starting Sales navigation via Reports", "navigation_method": "reports_nav_after_login", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "ts": "2026-01-05T11:05:20.066853+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Waiting for Reports navigation selector", "navigation_method": "reports_nav_after_login", "nav_selector": "#achrOrderReport", "ts": "2026-01-05T11:05:20.066891+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Reports navigation selector available", "navigation_method": "reports_nav_after_login", "nav_selector": "#achrOrderReport", "ts": "2026-01-05T11:05:20.075799+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Clicking Reports navigation selector", "navigation_method": "reports_nav_after_login", "nav_selector": "#achrOrderReport", "ts": "2026-01-05T11:05:20.075883+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Clicked Reports navigation selector", "navigation_method": "reports_nav_after_login", "nav_selector": "#achrOrderReport", "ts": "2026-01-05T11:05:21.133511+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Waiting for Sales link selector", "navigation_method": "reports_nav_after_login", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "ts": "2026-01-05T11:05:21.133628+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Sales link selector available", "navigation_method": "reports_nav_after_login", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "ts": "2026-01-05T11:05:21.557916+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Clicking Sales link selector", "navigation_method": "reports_nav_after_login", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "ts": "2026-01-05T11:05:21.558022+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Clicked Sales link selector", "navigation_method": "reports_nav_after_login", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "ts": "2026-01-05T11:05:21.822217+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Waiting for Sales URL match after Reports navigation", "navigation_method": "reports_nav_after_login", "target_pattern": "/A668/App/Reports/NEWSalesAndDeliveryReport", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "ts": "2026-01-05T11:05:21.822323+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Finished waiting for Sales URL after Reports navigation", "navigation_method": "reports_nav_after_login", "target_pattern": "/A668/App/Reports/NEWSalesAndDeliveryReport", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "ts": "2026-01-05T11:05:21.912443+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Sales navigation attempt", "navigation_method": "reports_nav", "attempt": "after_login", "retry_status": "after_login", "success": true, "final_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport?ClearContent=05%20Jan%202026%2016:35:21:120", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "ok", "ts": "2026-01-05T11:05:21.912643+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Navigated to Sales & Delivery report page via Reports navigation after login", "final_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport?ClearContent=05%20Jan%202026%2016:35:21:120", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "navigation_method": "reports_nav_after_login", "retry_status": "after_login", "attempts": [{"navigation_method": "direct", "attempt": "initial", "retry_status": "initial", "success": false, "final_url": "https://subs.quickdrycleaning.com/Login", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "login_redirect"}, {"navigation_method": "reports_nav", "attempt": "after_login", "retry_status": "after_login", "success": true, "final_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport?ClearContent=05%20Jan%202026%2016:35:21:120", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "ok"}], "ts": "2026-01-05T11:05:21.913890+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": null, "message": "Sales navigation outcome", "navigation_method": "reports_nav_after_login", "retry_status": "after_login", "final_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport?ClearContent=05%20Jan%202026%2016:35:21:120", "reason": null, "attempts": [{"navigation_method": "direct", "attempt": "initial", "retry_status": "initial", "success": false, "final_url": "https://subs.quickdrycleaning.com/Login", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "login_redirect"}, {"navigation_method": "reports_nav", "attempt": "after_login", "retry_status": "after_login", "success": true, "final_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport?ClearContent=05%20Jan%202026%2016:35:21:120", "target_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "ok"}], "ts": "2026-01-05T11:05:21.914329+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Report container ready; iframe attached", "final_url": "https://subs.quickdrycleaning.com/a668/App/Reports/NEWSalesAndDeliveryReport?ClearContent=05%20Jan%202026%2016:35:21:120", "iframe_src_hostname": "reports.quickdrycleaning.com", "iframe_src_prefix": "https://reports.quickdrycleaning.com/en/sales-and-delivery?token", "iframe_src_length": 764, "iframe_attached": true, "ts": "2026-01-05T11:05:21.959441+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Iframe hydration observations", "observed_controls": [{"label": "download_link", "count": 1, "texts": ["Download historical report"]}], "observed_spinners": [{"label": "kendo_loading_mask", "selector": ".k-loading-mask", "count": 0, "visible": false, "ever_visible": false, "waited_for_hidden": false}, {"label": "progress_loader", "selector": "img[alt*='loading' i]", "count": 0, "visible": false, "ever_visible": false, "waited_for_hidden": false}, {"label": "loading_text", "selector": "text=/loading/i", "count": 1, "visible": true, "ever_visible": true, "waited_for_hidden": true}], "ts": "2026-01-05T11:05:23.981385+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Date range set via date-range control", "from_value": "2025-12-06", "to_value": "2026-01-05", "numeric_input_count": 6, "used_numeric_triplets": true, "range_text": "Dec 6, 2025 - Jan 5, 2026", "update_click": {"found": true, "clicked": true}, "attempt": 1, "ts": "2026-01-05T11:05:31.231884+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Report modal closed after request", "waited_ms": 366, "ts": "2026-01-05T11:05:31.691873+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Iframe body log executed", "label": "iframe_body_after_modal_close", "body_log_attempted": true, "body_html_captured": false, "body_html_length": null, "ts": "2026-01-05T11:05:31.692005+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Report Requests container located", "container_locator_strategy": "heading_preferred_wrapper", "ts": "2026-01-05T11:05:31.770789+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Using TD orders locator strategies", "container_locator_strategy": "heading_preferred_wrapper", "range_match_strategy": "date_range_text_pattern", "download_locator_strategy": "href_contains_order_reports", "ts": "2026-01-05T11:05:31.770918+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Observed Report Requests rows", "row_count": 6, "first_row_text": "S. No. Date Range Requested Status", "matched_range_examples": ["S. No. Date Range Requested Status", "06 Dec 2025 - 05 Jan 2026", "Report Requests Refresh"], "container_locator_strategy": "heading_preferred_wrapper", "ts": "2026-01-05T11:05:32.052247+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Captured Report Requests container structure", "label": "report_requests_after_request", "row_count": 9, "container_locator_strategy": "heading_preferred_wrapper", "ts": "2026-01-05T11:05:32.250293+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Selected Report Requests row for follow-up", "matched_range_text": "06 Dec 2025 - 05 Jan 2026", "status_text": "1 06 Dec 2025 - 05 Jan 2026 05 Jan 2026 04:35 PM Download", "expected_range_texts": ["Dec 6, 2025 - Jan 5, 2026", "06 Dec 2025 - 05 Jan 2026", "Dec 06, 2025 - Jan 05, 2026", "Dec 06 2025 - Jan 05 2026", "06 Dec 2025 - 5 Jan 2026", "Dec 06, 2025 - Jan 5, 2026", "Dec 06 2025 - Jan 5 2026", "6 Dec 2025 - 05 Jan 2026", "Dec 6, 2025 - Jan 05, 2026", "Dec 6 2025 - Jan 05 2026", "6 Dec 2025 - 5 Jan 2026", "Dec 6 2025 - Jan 5 2026"], "all_row_texts": ["06 Dec 2025 - 05 Jan 2026", "06 Dec 2025 - 05 Jan 2026", "06 Dec 2025 - 05 Jan 2026", "06 Dec 2025 - 05 Jan 2026", "06 Dec 2025 - 05 Jan 2026", "06 Dec 2025 - 05 Jan 2026"], "range_match_strategy": "date_range_text_pattern", "download_locator_strategy": "href_contains_sales_reports", "container_locator_strategy": "heading_preferred_wrapper", "selected_row_state": "downloadable", "selection_source": "downloadable_row", "ts": "2026-01-05T11:07:02.810996+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Report Requests row ready for download", "matched_range_text": "06 Dec 2025 - 05 Jan 2026", "status_text": "1 06 Dec 2025 - 05 Jan 2026 05 Jan 2026 04:35 PM Download", "expected_range_texts": ["Dec 6, 2025 - Jan 5, 2026", "06 Dec 2025 - 05 Jan 2026", "Dec 06, 2025 - Jan 05, 2026", "Dec 06 2025 - Jan 05 2026", "06 Dec 2025 - 5 Jan 2026", "Dec 06, 2025 - Jan 5, 2026", "Dec 06 2025 - Jan 5 2026", "6 Dec 2025 - 05 Jan 2026", "Dec 6, 2025 - Jan 05, 2026", "Dec 6 2025 - Jan 05 2026", "6 Dec 2025 - 5 Jan 2026", "Dec 6 2025 - Jan 5 2026"], "all_row_texts": ["06 Dec 2025 - 05 Jan 2026", "06 Dec 2025 - 05 Jan 2026", "06 Dec 2025 - 05 Jan 2026", "06 Dec 2025 - 05 Jan 2026", "06 Dec 2025 - 05 Jan 2026", "06 Dec 2025 - 05 Jan 2026"], "download_control_visible": true, "matched_row_text_full": "06 Dec 2025 - 05 Jan 2026", "range_match_strategy": "date_range_text_pattern", "download_locator_strategy": "href_contains_sales_reports", "container_locator_strategy": "heading_preferred_wrapper", "selected_row_state": "downloadable", "selection_source": "downloadable_row", "ts": "2026-01-05T11:07:02.811953+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Orders report download saved", "download_path": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/data/A668_td_sales_20251206_20260105.xlsx", "suggested_filename": "1170-ggko_-6jtZv0KbDOs4tsZ.xlsx", "matched_range_text": "06 Dec 2025 - 05 Jan 2026", "expected_range_texts": ["Dec 6, 2025 - Jan 5, 2026", "06 Dec 2025 - 05 Jan 2026", "Dec 06, 2025 - Jan 05, 2026", "Dec 06 2025 - Jan 05 2026", "06 Dec 2025 - 5 Jan 2026", "Dec 06, 2025 - Jan 5, 2026", "Dec 06 2025 - Jan 5 2026", "6 Dec 2025 - 05 Jan 2026", "Dec 6, 2025 - Jan 05, 2026", "Dec 6 2025 - Jan 05 2026", "6 Dec 2025 - 5 Jan 2026", "Dec 6 2025 - Jan 5 2026"], "download_locator_strategy": "href_contains_sales_reports", "range_match_strategy": "date_range_text_pattern", "container_locator_strategy": "heading_preferred_wrapper", "selected_row_state": "downloadable", "selection_source": "downloadable_row", "ts": "2026-01-05T11:07:03.350886+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales", "status": "ok", "message": "Sales & Delivery report downloaded", "download_path": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/data/A668_td_sales_20251206_20260105.xlsx", "ts": "2026-01-05T11:07:03.351394+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "sales_ingest", "status": "error", "message": "TD Sales ingestion failed", "error": "(sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column \"ingest_remark\" of relation \"stg_td_sales\" does not exist\n[SQL: INSERT INTO stg_td_sales (run_id, run_date, cost_center, store_code, order_date, payment_date, order_number, customer_code, customer_name, customer_address, mobile_number, payment_received, adjustments, balance, accepted_by, payment_mode, transaction_id, payment_made_at, order_type, is_duplicate, is_edited_order, ingest_remark) VALUES ($1::VARCHAR, $2::TIMESTAMP WITH TIME ZONE, $3::VARCHAR, $4::VARCHAR, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::NUMERIC(12, 2), $13::NUMERIC(12, 2), $14::NUMERIC(12, 2), $15::VARCHAR, $16::VARCHAR, $17::VARCHAR, $18::VARCHAR, $19::VARCHAR, $20::BOOLEAN, $21::BOOLEAN, $22::VARCHAR) ON CONFLICT (store_code, order_number, payment_date) DO UPDATE SET run_id = excluded.run_id, run_date = excluded.run_date, cost_center = excluded.cost_center, store_code = excluded.store_code, order_date = excluded.order_date, payment_date = excluded.payment_date, order_number = excluded.order_number, customer_code = excluded.customer_code, customer_name = excluded.customer_name, customer_address = excluded.customer_address, mobile_number = excluded.mobile_number, payment_received = excluded.payment_received, adjustments = excluded.adjustments, balance = excluded.balance, accepted_by = excluded.accepted_by, payment_mode = excluded.payment_mode, transaction_id = excluded.transaction_id, payment_made_at = excluded.payment_made_at, order_type = excluded.order_type, is_duplicate = excluded.is_duplicate, is_edited_order = excluded.is_edited_order, ingest_remark = excluded.ingest_remark RETURNING stg_td_sales.id]\n[parameters: ('20260105_110335387553', datetime.datetime(2026, 1, 5, 16, 33, 35, 390904, tzinfo=zoneinfo.ZoneInfo(key='Asia/Kolkata')), 'UN3668', 'A668', datetime.datetime(2025, 9, 21, 0, 0, tzinfo=zoneinfo.ZoneInfo(key='Asia/Kolkata')), datetime.datetime(2025, 12, 14, 10, 10, 41, tzinfo=zoneinfo.ZoneInfo(key='Asia/Kolkata')), 'T1130', 'Cust2490489', 'Is same day delivery possible??', 'House no 44 flat no 106 Wednesday market opposite Bharat apartment near Shani mandir   uttam nagar west  jain colony part 3  delhi', '7880917410', Decimal('676'), Decimal('0'), Decimal('0'), 'TDuttamNagar', 'Cash', None, 'Walk in Customer', 'Order', False, False, None)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "ts": "2026-01-05T11:07:03.626773+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A668", "phase": "store", "status": "ok", "message": "Completed TD orders store discovery", "session_reused": true, "ts": "2026-01-05T11:07:03.627356+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "store", "status": "ok", "message": "Starting TD orders store discovery", "run_env": "dev", "from_date": "2025-12-06", "to_date": "2026-01-05", "ts": "2026-01-05T11:07:03.718059+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "session", "status": "ok", "message": "Storage state found; probing session validity", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "ts": "2026-01-05T11:07:04.329431+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "session", "status": "warn", "message": "Probed session with existing storage state", "response_status": 200, "final_url": "https://subs.quickdrycleaning.com/Login", "contains_store_code": false, "verification_seen": false, "login_detected": true, "nav_visible": false, "home_card_visible": false, "state_valid": false, "invalid_reason": "login_form_visible", "probe_error": null, "probe_target": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "contains_store_path": false, "ts": "2026-01-05T11:07:10.014615+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "session", "status": "ok", "message": "Storage state probe invalid; performing login", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "probe_reason": "login_form_visible", "probe_valid": false, "verification_seen": false, "nav_visible": false, "home_card_visible": false, "re_login_performed": true, "ts": "2026-01-05T11:07:10.015097+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "login", "status": "ok", "message": "Completed login attempt", "final_url": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "contains_store_code": true, "post_login_wait_completed": "url_contains_store_code", "post_login_wait_error": null, "submit_error": null, "selectors": {"username": "#txtUserId", "password": "#txtPassword", "store_code": "#txtBranchPin", "submit": "#btnLogin"}, "ts": "2026-01-05T11:07:11.153678+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "session", "status": "ok", "message": "Login completed; session ready", "final_url": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "probe_reason": "login_form_visible", "probe_valid": false, "login_performed": true, "re_login_performed": true, "ts": "2026-01-05T11:07:11.153845+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "session", "status": "ok", "message": "Session ready after OTP/verification wait", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "final_url": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "verification_seen": false, "login_performed": true, "ts": "2026-01-05T11:07:11.153999+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "login", "status": "ok", "message": "Home page ready after login/verification", "final_url": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "nav_selector": "#achrOrderReport", "nav_visible": true, "home_card_visible": false, "ts": "2026-01-05T11:07:11.957634+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "home", "status": "ok", "message": "Navigation controls snapshot", "links": [{"index": 0, "text": "Home    \n(Ctrl+H)", "href": "home.html?ClearContent=1-0-2026 16:37:11", "visible": true}, {"index": 1, "text": "Dashboard", "href": "Bookings_New/frmDashBoard.aspx?ClearContent=1-0-2026 16:37:11", "visible": false}, {"index": 2, "text": "Customer", "href": "New_Admin/frmNewCustomer.aspx?ClearContent=1-0-2026 16:37:11", "visible": true}, {"index": 3, "text": "Drop (F1)", "href": "", "visible": false}, {"index": 4, "text": "Reports", "href": "Reports/OrderReport.aspx?ClearContent=1-0-2026 16:37:11", "visible": true}], "ts": "2026-01-05T11:07:12.063492+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "session", "status": "ok", "message": "Stored refreshed session state after home detection", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "verification_seen": false, "ts": "2026-01-05T11:07:12.071691+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "session", "status": "ok", "message": "Persisted storage state for A817 after home detection", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "session_reused": true, "refreshed": true, "ts": "2026-01-05T11:07:12.071809+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "orders", "status": "ok", "message": "Skipping Orders iframe flow because Orders segment was disabled by flag", "ts": "2026-01-05T11:07:12.071889+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Starting Sales navigation via direct URL", "navigation_method": "direct", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "ts": "2026-01-05T11:07:12.072220+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Waiting for Sales URL match after direct navigation", "navigation_method": "direct", "target_pattern": "/A817/App/Reports/NEWSalesAndDeliveryReport", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "ts": "2026-01-05T11:07:12.245727+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "warn", "message": "Sales destination validation failed after direct navigation", "navigation_method": "direct", "final_url": "https://subs.quickdrycleaning.com/Login", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "contains_store_code": false, "contains_sales_path": false, "is_login_url": true, "ts": "2026-01-05T11:08:42.264312+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Sales navigation attempt", "navigation_method": "direct", "attempt": "initial", "retry_status": "initial", "success": false, "final_url": "https://subs.quickdrycleaning.com/Login", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "login_redirect", "ts": "2026-01-05T11:08:42.264717+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "login", "status": "ok", "message": "Completed login attempt", "final_url": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "contains_store_code": true, "post_login_wait_completed": "url_contains_store_code", "post_login_wait_error": null, "submit_error": null, "selectors": {"username": "#txtUserId", "password": "#txtPassword", "store_code": "#txtBranchPin", "submit": "#btnLogin"}, "ts": "2026-01-05T11:08:43.319906+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "login", "status": "ok", "message": "Home page ready after login/verification", "final_url": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "nav_selector": "#achrOrderReport", "nav_visible": true, "home_card_visible": false, "ts": "2026-01-05T11:08:45.221865+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Refreshed storage state after Sales re-login", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "final_url": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "ts": "2026-01-05T11:08:45.230302+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Retrying Sales navigation via Reports after login redirect or validation failure", "retry_status": "after_login", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "last_reason": "login_redirect", "ts": "2026-01-05T11:08:45.230398+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Starting Sales navigation via Reports", "navigation_method": "reports_nav_after_login", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "ts": "2026-01-05T11:08:45.230445+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Waiting for Reports navigation selector", "navigation_method": "reports_nav_after_login", "nav_selector": "#achrOrderReport", "ts": "2026-01-05T11:08:45.230482+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Reports navigation selector available", "navigation_method": "reports_nav_after_login", "nav_selector": "#achrOrderReport", "ts": "2026-01-05T11:08:45.240380+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Clicking Reports navigation selector", "navigation_method": "reports_nav_after_login", "nav_selector": "#achrOrderReport", "ts": "2026-01-05T11:08:45.240467+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Clicked Reports navigation selector", "navigation_method": "reports_nav_after_login", "nav_selector": "#achrOrderReport", "ts": "2026-01-05T11:08:45.692008+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Waiting for Sales link selector", "navigation_method": "reports_nav_after_login", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "ts": "2026-01-05T11:08:45.692202+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Sales navigation attempt", "navigation_method": "reports_nav", "attempt": "after_login", "retry_status": "after_login", "success": false, "final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=1-0-2026%2016:38:45", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "sales_link_missing", "ts": "2026-01-05T11:10:15.748050+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Falling back to Reports navigation for Sales", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "last_final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=1-0-2026%2016:38:45", "last_reason": "sales_link_missing", "ts": "2026-01-05T11:10:15.748449+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Starting Sales navigation via Reports", "navigation_method": "reports_nav", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "ts": "2026-01-05T11:10:15.748541+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Waiting for Reports navigation selector", "navigation_method": "reports_nav", "nav_selector": "#achrOrderReport", "ts": "2026-01-05T11:10:15.748601+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "ok", "message": "Sales navigation attempt", "navigation_method": "reports_nav", "attempt": "primary", "retry_status": "primary", "success": false, "final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=1-0-2026%2016:38:45", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "nav_selector_missing", "ts": "2026-01-05T11:11:45.752863+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "warn", "message": "Sales & Delivery report navigation failed after retry", "final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=1-0-2026%2016:38:45", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "reason": "nav_selector_missing", "attempts": [{"navigation_method": "direct", "attempt": "initial", "retry_status": "initial", "success": false, "final_url": "https://subs.quickdrycleaning.com/Login", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "login_redirect"}, {"navigation_method": "reports_nav", "attempt": "after_login", "retry_status": "after_login", "success": false, "final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=1-0-2026%2016:38:45", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "sales_link_missing"}, {"navigation_method": "reports_nav", "attempt": "primary", "retry_status": "primary", "success": false, "final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=1-0-2026%2016:38:45", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "nav_selector_missing"}], "navigation_method": "reports_nav", "retry_status": "primary", "ts": "2026-01-05T11:11:45.753996+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "warn", "message": "Sales navigation outcome", "navigation_method": "reports_nav", "retry_status": "primary", "final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=1-0-2026%2016:38:45", "reason": "nav_selector_missing", "attempts": [{"navigation_method": "direct", "attempt": "initial", "retry_status": "initial", "success": false, "final_url": "https://subs.quickdrycleaning.com/Login", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "login_redirect"}, {"navigation_method": "reports_nav", "attempt": "after_login", "retry_status": "after_login", "success": false, "final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=1-0-2026%2016:38:45", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "sales_link_missing"}, {"navigation_method": "reports_nav", "attempt": "primary", "retry_status": "primary", "success": false, "final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=1-0-2026%2016:38:45", "target_url": "https://subs.quickdrycleaning.com/a817/App/Reports/NEWSalesAndDeliveryReport", "nav_selector": "#achrOrderReport", "sales_link_selector": "a[href*='NEWSalesAndDeliveryReport'], a[href*='SalesAndDeliveryReport']", "reason": "nav_selector_missing"}], "ts": "2026-01-05T11:11:45.754476+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "sales", "status": "warn", "message": "Navigation to Sales & Delivery report did not complete", "final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=1-0-2026%2016:38:45", "ts": "2026-01-05T11:11:45.754793+00:00"}
{"run_id": "20260105_110335387553", "store_code": "A817", "phase": "store", "status": "ok", "message": "Completed TD orders store discovery", "session_reused": true, "ts": "2026-01-05T11:11:45.754930+00:00"}
{"run_id": "20260105_110335387553", "phase": "notifications", "status": "ok", "message": "TD orders sync discovery flow complete; notifying", "run_env": "dev", "ts": "2026-01-05T11:11:46.403374+00:00"}
{"run_id": "20260105_110335387553", "phase": "run_summary", "status": "ok", "message": "Run summary inserted", "overall_status": "error", "ts": "2026-01-05T11:11:46.550776+00:00"}
