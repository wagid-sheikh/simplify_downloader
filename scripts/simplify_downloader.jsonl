wagidsheikh@Wagids-MacBook-Pro simplify_downloader % ./scripts/run_local_td_orders_sync.sh
{"run_id": "20260104_122748403746", "phase": "init", "status": "ok", "message": "Starting TD orders sync discovery flow", "run_env": "dev", "from_date": "2025-12-05", "to_date": "2026-01-04", "ts": "2026-01-04T12:27:48.404138+00:00"}
{"run_id": "20260104_122748403746", "phase": "init", "status": "warn", "message": "Temporarily restricting TD orders discovery to a subset of stores", "stores": ["A668", "A817"], "skipped_stores": null, "ts": "2026-01-04T12:27:48.468789+00:00"}
{"run_id": "20260104_122748403746", "phase": "init", "status": "ok", "message": "Loaded TD store rows", "store_count": 2, "stores": ["A668", "A817"], "ts": "2026-01-04T12:27:48.468890+00:00"}
{"run_id": "20260104_122748403746", "phase": "init", "status": "ok", "message": "Launching Playwright with local Chrome executable", "backend": "local_chrome", "executable_path": "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome", "headless": false, "ts": "2026-01-04T12:27:49.498560+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "store", "status": "ok", "message": "Starting TD orders store discovery", "run_env": "dev", "from_date": "2025-12-05", "to_date": "2026-01-04", "ts": "2026-01-04T12:27:50.235259+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "session", "status": "ok", "message": "Storage state found; probing session validity", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A668_storage_state.json", "ts": "2026-01-04T12:27:50.920276+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "session", "status": "warn", "message": "Probed session with existing storage state", "response_status": 200, "final_url": "https://subs.quickdrycleaning.com/Login", "contains_store_code": false, "verification_seen": false, "login_detected": true, "nav_visible": false, "home_card_visible": false, "state_valid": false, "invalid_reason": "login_form_visible", "probe_error": null, "probe_target": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "contains_store_path": false, "ts": "2026-01-04T12:27:56.344864+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "session", "status": "ok", "message": "Storage state probe invalid; performing login", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A668_storage_state.json", "probe_reason": "login_form_visible", "probe_valid": false, "verification_seen": false, "nav_visible": false, "home_card_visible": false, "re_login_performed": true, "ts": "2026-01-04T12:27:56.345083+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "login", "status": "ok", "message": "Completed login attempt", "final_url": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "contains_store_code": true, "post_login_wait_completed": "url_contains_store_code", "post_login_wait_error": null, "submit_error": null, "selectors": {"username": "#txtUserId", "password": "#txtPassword", "store_code": "#txtBranchPin", "submit": "#btnLogin"}, "ts": "2026-01-04T12:27:57.506271+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "session", "status": "ok", "message": "Login completed; session ready", "final_url": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A668_storage_state.json", "probe_reason": "login_form_visible", "probe_valid": false, "login_performed": true, "re_login_performed": true, "ts": "2026-01-04T12:27:57.506428+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "session", "status": "ok", "message": "Session ready after OTP/verification wait", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A668_storage_state.json", "final_url": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "verification_seen": false, "login_performed": true, "ts": "2026-01-04T12:27:57.506526+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "login", "status": "ok", "message": "Home page ready after login/verification", "final_url": "https://subs.quickdrycleaning.com/a668/App/home?EventClick=True", "nav_selector": "#achrOrderReport", "nav_visible": true, "home_card_visible": false, "ts": "2026-01-04T12:28:00.460786+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "home", "status": "ok", "message": "Navigation controls snapshot", "links": [{"index": 0, "text": "Home    \n(Ctrl+H)", "href": "home.html?ClearContent=0-0-2026 17:58:0", "visible": true}, {"index": 1, "text": "Dashboard", "href": "Bookings_New/frmDashBoard.aspx?ClearContent=0-0-2026 17:58:0", "visible": true}, {"index": 2, "text": "Customer", "href": "New_Admin/frmNewCustomer.aspx?ClearContent=0-0-2026 17:58:0", "visible": true}, {"index": 3, "text": "Drop (F1)", "href": "", "visible": false}, {"index": 4, "text": "Reports", "href": "Reports/OrderReport.aspx?ClearContent=0-0-2026 17:58:0", "visible": true}], "ts": "2026-01-04T12:28:00.585039+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "session", "status": "ok", "message": "Stored refreshed session state after home detection", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A668_storage_state.json", "verification_seen": false, "ts": "2026-01-04T12:28:00.595757+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "orders", "status": "ok", "message": "Navigated to Orders container via Reports entry", "final_url": "https://subs.quickdrycleaning.com/a668/App/Reports/OrderReport?ClearContent=0-0-2026%2017:58:0", "nav_selector": "#achrOrderReport", "ts": "2026-01-04T12:28:02.427451+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "orders", "status": "ok", "message": "Orders container ready; iframe attached", "final_url": "https://subs.quickdrycleaning.com/a668/App/Reports/OrderReport?ClearContent=0-0-2026%2017:58:0", "iframe_src": "https://reports.quickdrycleaning.com/en/order-report?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJRRENUZXN0IiwiZW1haWwiOiJRRENUZXN0VG9rZW5AdGVzdGluZy5jb20iLCJDbGllbnRJRCI6IjM2MTgxIiwiQnJhbmNoSUQiOiIxMTcwIiwiVXNlck5hbWUiOiJURHV0dGFtTmFnYXIiLCJJc0V4cG9ydFRvRXhjZWxSaWdodCI6InRydWUiLCJJc1ZpZXdNb2JpbGVOdW1iZXIiOiJ0cnVlIiwiQ3VzdG9tZXJTZWFyY2hNaW5DaGFyYWN0ZXIiOiIzIiwiSXNDdXN0b21lckFsbERhdGFFeHBvcnR0b0V4Y2VsIjoidHJ1ZSIsIklzQ3VzdG9tZXJBbGxEYXRhTW9iaWxlU2hvdyI6InRydWUiLCJPcmdhbml6YXRpb25JRCI6IjM3NTciLCJVc2VyRW1haWwiOiJzaGF3QHRoZXNoYXd2ZW50dXJlcy5jb20iLCJqdGkiOiI0NDlmMjRmZS1kNDU4LTRkOTktOGFiYi03YThlODUyYjg0Y2EiLCJleHAiOjE3Njc1MzY4ODMsImlzcyI6InRlc3RxZGMiLCJhdWQiOiJxZGMtdG9rZW4ifQ.4o2ArHxBA1G7wlCCIl6P9YgK-KQNco_9jHHIlO9KUOI&source=store&oldUrl=", "iframe_attached": true, "ts": "2026-01-04T12:28:02.498033+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Iframe hydration observations", "observed_controls": [{"label": "download_link", "count": 1, "texts": ["Download historical report"]}], "observed_spinners": [{"label": "kendo_loading_mask", "selector": ".k-loading-mask", "count": 0, "visible": false, "ever_visible": false, "waited_for_hidden": false}, {"label": "progress_loader", "selector": "img[alt*='loading' i]", "count": 0, "visible": false, "ever_visible": false, "waited_for_hidden": false}, {"label": "loading_text", "selector": "text=/loading/i", "count": 1, "visible": true, "ever_visible": true, "waited_for_hidden": true}], "ts": "2026-01-04T12:28:06.273879+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Clicked Expand button inside iframe", "ts": "2026-01-04T12:28:06.395462+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Date range set via date-range control", "from_value": "2025-12-05", "to_value": "2026-01-04", "numeric_input_count": 6, "used_numeric_triplets": true, "control_attempts": [{"label": "button_with_range_text", "count": 1, "used": true}], "locate_attempts": [], "fill_details": null, "selection_details": null, "numeric_fill_details": [{"label": "from", "strategy": "numeric_triplet", "field_count": 3, "values": {"day": "05", "month": "12", "year": "2025"}, "fills": [{"part": "day", "value": "05", "filled": true}, {"part": "month", "value": "12", "filled": true}, {"part": "year", "value": "2025", "filled": true}]}, {"label": "to", "strategy": "numeric_triplet", "field_count": 3, "values": {"day": "04", "month": "01", "year": "2026"}, "fills": [{"part": "day", "value": "04", "filled": true}, {"part": "month", "value": "01", "filled": true}, {"part": "year", "value": "2026", "filled": true}]}], "range_text": "Dec 5, 2025 - Jan 4, 2026", "picker_dom_length": 600, "update_click": {"found": true, "clicked": true}, "attempt": 1, "ts": "2026-01-04T12:28:08.521384+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Report modal closed after request", "waited_ms": 369, "ts": "2026-01-04T12:28:08.986971+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Captured iframe body HTML", "label": "iframe_body_after_modal_close", "body_html_length": 20454, "ts": "2026-01-04T12:28:09.005226+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Report Requests container located", "container_locator_strategy": "heading_preferred_wrapper", "ts": "2026-01-04T12:28:09.083290+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Using TD orders locator strategies", "container_locator_strategy": "heading_preferred_wrapper", "range_match_strategy": "date_range_text_pattern", "download_locator_strategy": "href_contains_order_reports", "ts": "2026-01-04T12:28:09.083373+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Observed Report Requests rows", "rows": ["S. No. Date Range Requested Status", "1 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 05:58 PM Pending, Estimated Time 0m 45s", "2 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 05:35 PM Download", "3 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 01:03 PM Download", "4 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 10:44 AM Download", "5 04 Dec 2025 - 03 Jan 2026 03 Jan 2026 10:34 PM Download", "6 04 Dec 2025 - 03 Jan 2026 03 Jan 2026 09:30 PM Download", "7 04 Dec 2025 - 03 Jan 2026 03 Jan 2026 09:10 PM Download", "8 04 Dec 2025 - 03 Jan 2026 03 Jan 2026 08:44 PM Download", "9 04 Dec 2025 - 03 Jan 2026 03 Jan 2026 08:28 PM Download"], "container_locator_strategy": "heading_preferred_wrapper", "ts": "2026-01-04T12:28:10.074924+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Captured Report Requests container outerHTML", "label": "report_requests_after_request", "outer_html_length": 8810, "ts": "2026-01-04T12:28:10.097757+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Selected Report Requests row for follow-up", "matched_range_text": "05 Dec 2025 - 04 Jan 2026", "status_text": "1 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 05:58 PM Download", "expected_range_texts": ["Dec 5, 2025 - Jan 4, 2026", "05 Dec 2025 - 04 Jan 2026", "Dec 05, 2025 - Jan 04, 2026", "Dec 05 2025 - Jan 04 2026", "05 Dec 2025 - 4 Jan 2026", "Dec 05, 2025 - Jan 4, 2026", "Dec 05 2025 - Jan 4 2026", "5 Dec 2025 - 04 Jan 2026", "Dec 5, 2025 - Jan 04, 2026", "Dec 5 2025 - Jan 04 2026", "5 Dec 2025 - 4 Jan 2026", "Dec 5 2025 - Jan 4 2026"], "all_row_texts": ["05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026"], "range_match_strategy": "date_range_text_pattern", "download_locator_strategy": "href_contains_order_reports", "container_locator_strategy": "heading_preferred_wrapper", "selected_row_state": "downloadable", "selection_source": "downloadable_row", "ts": "2026-01-04T12:29:41.930784+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Report Requests row ready for download", "matched_range_text": "05 Dec 2025 - 04 Jan 2026", "status_text": "1 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 05:58 PM Download", "expected_range_texts": ["Dec 5, 2025 - Jan 4, 2026", "05 Dec 2025 - 04 Jan 2026", "Dec 05, 2025 - Jan 04, 2026", "Dec 05 2025 - Jan 04 2026", "05 Dec 2025 - 4 Jan 2026", "Dec 05, 2025 - Jan 4, 2026", "Dec 05 2025 - Jan 4 2026", "5 Dec 2025 - 04 Jan 2026", "Dec 5, 2025 - Jan 04, 2026", "Dec 5 2025 - Jan 04 2026", "5 Dec 2025 - 4 Jan 2026", "Dec 5 2025 - Jan 4 2026"], "all_row_texts": ["05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026"], "download_control_visible": true, "matched_row_text_full": "05 Dec 2025 - 04 Jan 2026", "range_match_strategy": "date_range_text_pattern", "download_locator_strategy": "href_contains_order_reports", "container_locator_strategy": "heading_preferred_wrapper", "selected_row_state": "downloadable", "selection_source": "downloadable_row", "ts": "2026-01-04T12:29:41.931656+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Orders report download saved", "download_path": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/data/A668_td_orders_20251205_20260104.xlsx", "suggested_filename": "1170-_MbRaPydNkB-JDsS4xvKW.xlsx", "matched_range_text": "05 Dec 2025 - 04 Jan 2026", "expected_range_texts": ["Dec 5, 2025 - Jan 4, 2026", "05 Dec 2025 - 04 Jan 2026", "Dec 05, 2025 - Jan 04, 2026", "Dec 05 2025 - Jan 04 2026", "05 Dec 2025 - 4 Jan 2026", "Dec 05, 2025 - Jan 4, 2026", "Dec 05 2025 - Jan 4 2026", "5 Dec 2025 - 04 Jan 2026", "Dec 5, 2025 - Jan 04, 2026", "Dec 5 2025 - Jan 04 2026", "5 Dec 2025 - 4 Jan 2026", "Dec 5 2025 - Jan 4 2026"], "download_locator_strategy": "href_contains_order_reports", "range_match_strategy": "date_range_text_pattern", "container_locator_strategy": "heading_preferred_wrapper", "selected_row_state": "downloadable", "selection_source": "downloadable_row", "ts": "2026-01-04T12:29:42.360808+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "ingest", "status": "warn", "message": "TD Orders workbook ingested with warnings", "warnings": ["Invalid phone number dropped: A668--7051"], "staging_rows": 245, "final_rows": 245, "ts": "2026-01-04T12:29:44.385824+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "iframe", "status": "ok", "message": "Orders iframe flow completed", "download_path": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/data/A668_td_orders_20251205_20260104.xlsx", "ts": "2026-01-04T12:29:44.385954+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A668", "phase": "store", "status": "ok", "message": "Completed TD orders store discovery", "session_reused": true, "ts": "2026-01-04T12:29:44.386019+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "store", "status": "ok", "message": "Starting TD orders store discovery", "run_env": "dev", "from_date": "2025-12-05", "to_date": "2026-01-04", "ts": "2026-01-04T12:29:44.454281+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "session", "status": "ok", "message": "Storage state found; probing session validity", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "ts": "2026-01-04T12:29:44.989932+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "session", "status": "warn", "message": "Probed session with existing storage state", "response_status": 200, "final_url": "https://subs.quickdrycleaning.com/Login", "contains_store_code": false, "verification_seen": false, "login_detected": true, "nav_visible": false, "home_card_visible": false, "state_valid": false, "invalid_reason": "login_form_visible", "probe_error": null, "probe_target": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "contains_store_path": false, "ts": "2026-01-04T12:29:50.623179+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "session", "status": "ok", "message": "Storage state probe invalid; performing login", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "probe_reason": "login_form_visible", "probe_valid": false, "verification_seen": false, "nav_visible": false, "home_card_visible": false, "re_login_performed": true, "ts": "2026-01-04T12:29:50.623381+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "login", "status": "ok", "message": "Completed login attempt", "final_url": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "contains_store_code": true, "post_login_wait_completed": "url_contains_store_code", "post_login_wait_error": null, "submit_error": null, "selectors": {"username": "#txtUserId", "password": "#txtPassword", "store_code": "#txtBranchPin", "submit": "#btnLogin"}, "ts": "2026-01-04T12:29:51.612882+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "session", "status": "ok", "message": "Login completed; session ready", "final_url": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "probe_reason": "login_form_visible", "probe_valid": false, "login_performed": true, "re_login_performed": true, "ts": "2026-01-04T12:29:51.613036+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "session", "status": "ok", "message": "Session ready after OTP/verification wait", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "final_url": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "verification_seen": false, "login_performed": true, "ts": "2026-01-04T12:29:51.613166+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "login", "status": "ok", "message": "Home page ready after login/verification", "final_url": "https://subs.quickdrycleaning.com/a817/App/home?EventClick=True", "nav_selector": "#achrOrderReport", "nav_visible": true, "home_card_visible": false, "ts": "2026-01-04T12:29:52.376920+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "home", "status": "ok", "message": "Navigation controls snapshot", "links": [{"index": 0, "text": "Home    \n(Ctrl+H)", "href": "home.html?ClearContent=0-0-2026 17:59:52", "visible": true}, {"index": 1, "text": "Dashboard", "href": "Bookings_New/frmDashBoard.aspx?ClearContent=0-0-2026 17:59:52", "visible": false}, {"index": 2, "text": "Customer", "href": "New_Admin/frmNewCustomer.aspx?ClearContent=0-0-2026 17:59:52", "visible": true}, {"index": 3, "text": "Drop (F1)", "href": "", "visible": false}, {"index": 4, "text": "Reports", "href": "Reports/OrderReport.aspx?ClearContent=0-0-2026 17:59:52", "visible": true}], "ts": "2026-01-04T12:29:52.484704+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "session", "status": "ok", "message": "Stored refreshed session state after home detection", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "verification_seen": false, "ts": "2026-01-04T12:29:52.492593+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "session", "status": "ok", "message": "Persisted storage state for A817 after home detection", "storage_state": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/profiles/A817_storage_state.json", "session_reused": true, "refreshed": true, "ts": "2026-01-04T12:29:52.492678+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "orders", "status": "ok", "message": "Navigated to Orders container via Reports entry", "final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=0-0-2026%2017:59:52", "nav_selector": "#achrOrderReport", "ts": "2026-01-04T12:29:53.178653+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "orders", "status": "ok", "message": "Orders container ready; iframe attached", "final_url": "https://subs.quickdrycleaning.com/a817/App/Reports/OrderReport?ClearContent=0-0-2026%2017:59:52", "iframe_src": "https://reports.quickdrycleaning.com/en/order-report?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJRRENUZXN0IiwiZW1haWwiOiJRRENUZXN0VG9rZW5AdGVzdGluZy5jb20iLCJDbGllbnRJRCI6IjM2MzkxIiwiQnJhbmNoSUQiOiIxMjQ3IiwiVXNlck5hbWUiOiJUREtpcnRpTmFnYXIiLCJJc0V4cG9ydFRvRXhjZWxSaWdodCI6InRydWUiLCJJc1ZpZXdNb2JpbGVOdW1iZXIiOiJ0cnVlIiwiQ3VzdG9tZXJTZWFyY2hNaW5DaGFyYWN0ZXIiOiIzIiwiSXNDdXN0b21lckFsbERhdGFFeHBvcnR0b0V4Y2VsIjoidHJ1ZSIsIklzQ3VzdG9tZXJBbGxEYXRhTW9iaWxlU2hvdyI6InRydWUiLCJPcmdhbml6YXRpb25JRCI6IjM3NTciLCJVc2VyRW1haWwiOiJzaGF3QHRoZXNoYXd2ZW50dXJlcy5jb20iLCJqdGkiOiIzM2E4MThjMi04YWNmLTQ2ZDktYTMzZC0zYzEzZDE3MmVmNDUiLCJleHAiOjE3Njc1MzY5OTQsImlzcyI6InRlc3RxZGMiLCJhdWQiOiJxZGMtdG9rZW4ifQ.UQjadHb997CHXI5_4OH_Ic1tIMEHp_5j2nwciM-XTeI&source=store&oldUrl=", "iframe_attached": true, "ts": "2026-01-04T12:29:53.325156+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Iframe hydration observations", "observed_controls": [{"label": "download_link", "count": 1, "texts": ["Download historical report"]}], "observed_spinners": [{"label": "kendo_loading_mask", "selector": ".k-loading-mask", "count": 0, "visible": false, "ever_visible": false, "waited_for_hidden": false}, {"label": "progress_loader", "selector": "img[alt*='loading' i]", "count": 0, "visible": false, "ever_visible": false, "waited_for_hidden": false}, {"label": "loading_text", "selector": "text=/loading/i", "count": 1, "visible": true, "ever_visible": true, "waited_for_hidden": true}], "ts": "2026-01-04T12:29:56.548891+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Clicked Expand button inside iframe", "ts": "2026-01-04T12:29:56.682314+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Date range set via date-range control", "from_value": "2025-12-05", "to_value": "2026-01-04", "numeric_input_count": 6, "used_numeric_triplets": true, "control_attempts": [{"label": "button_with_range_text", "count": 1, "used": true}], "locate_attempts": [], "fill_details": null, "selection_details": null, "numeric_fill_details": [{"label": "from", "strategy": "numeric_triplet", "field_count": 3, "values": {"day": "05", "month": "12", "year": "2025"}, "fills": [{"part": "day", "value": "05", "filled": true}, {"part": "month", "value": "12", "filled": true}, {"part": "year", "value": "2025", "filled": true}]}, {"label": "to", "strategy": "numeric_triplet", "field_count": 3, "values": {"day": "04", "month": "01", "year": "2026"}, "fills": [{"part": "day", "value": "04", "filled": true}, {"part": "month", "value": "01", "filled": true}, {"part": "year", "value": "2026", "filled": true}]}], "range_text": "Dec 5, 2025 - Jan 4, 2026", "picker_dom_length": 600, "update_click": {"found": true, "clicked": true}, "attempt": 1, "ts": "2026-01-04T12:29:58.845884+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Report modal closed after request", "waited_ms": 372, "ts": "2026-01-04T12:29:59.303043+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Captured iframe body HTML", "label": "iframe_body_after_modal_close", "body_html_length": 20454, "ts": "2026-01-04T12:29:59.319917+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Report Requests container located", "container_locator_strategy": "heading_preferred_wrapper", "ts": "2026-01-04T12:29:59.401446+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Using TD orders locator strategies", "container_locator_strategy": "heading_preferred_wrapper", "range_match_strategy": "date_range_text_pattern", "download_locator_strategy": "href_contains_order_reports", "ts": "2026-01-04T12:29:59.401548+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Observed Report Requests rows", "rows": ["S. No. Date Range Requested Status", "1 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 06:00 PM Pending, Estimated Time 0m 45s", "2 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 05:37 PM Download", "3 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 01:05 PM Download", "4 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 10:46 AM Download", "5 04 Dec 2025 - 03 Jan 2026 03 Jan 2026 10:36 PM Download", "6 04 Dec 2025 - 03 Jan 2026 03 Jan 2026 09:32 PM Download", "7 04 Dec 2025 - 03 Jan 2026 03 Jan 2026 09:12 PM Download", "8 04 Dec 2025 - 03 Jan 2026 03 Jan 2026 08:45 PM Download", "9 04 Dec 2025 - 03 Jan 2026 03 Jan 2026 08:29 PM Download"], "container_locator_strategy": "heading_preferred_wrapper", "ts": "2026-01-04T12:30:00.399371+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Captured Report Requests container outerHTML", "label": "report_requests_after_request", "outer_html_length": 8810, "ts": "2026-01-04T12:30:00.415466+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Selected Report Requests row for follow-up", "matched_range_text": "05 Dec 2025 - 04 Jan 2026", "status_text": "1 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 06:00 PM Download", "expected_range_texts": ["Dec 5, 2025 - Jan 4, 2026", "05 Dec 2025 - 04 Jan 2026", "Dec 05, 2025 - Jan 04, 2026", "Dec 05 2025 - Jan 04 2026", "05 Dec 2025 - 4 Jan 2026", "Dec 05, 2025 - Jan 4, 2026", "Dec 05 2025 - Jan 4 2026", "5 Dec 2025 - 04 Jan 2026", "Dec 5, 2025 - Jan 04, 2026", "Dec 5 2025 - Jan 04 2026", "5 Dec 2025 - 4 Jan 2026", "Dec 5 2025 - Jan 4 2026"], "all_row_texts": ["05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026"], "range_match_strategy": "date_range_text_pattern", "download_locator_strategy": "href_contains_order_reports", "container_locator_strategy": "heading_preferred_wrapper", "selected_row_state": "downloadable", "selection_source": "downloadable_row", "ts": "2026-01-04T12:31:32.293773+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Report Requests row ready for download", "matched_range_text": "05 Dec 2025 - 04 Jan 2026", "status_text": "1 05 Dec 2025 - 04 Jan 2026 04 Jan 2026 06:00 PM Download", "expected_range_texts": ["Dec 5, 2025 - Jan 4, 2026", "05 Dec 2025 - 04 Jan 2026", "Dec 05, 2025 - Jan 04, 2026", "Dec 05 2025 - Jan 04 2026", "05 Dec 2025 - 4 Jan 2026", "Dec 05, 2025 - Jan 4, 2026", "Dec 05 2025 - Jan 4 2026", "5 Dec 2025 - 04 Jan 2026", "Dec 5, 2025 - Jan 04, 2026", "Dec 5 2025 - Jan 04 2026", "5 Dec 2025 - 4 Jan 2026", "Dec 5 2025 - Jan 4 2026"], "all_row_texts": ["05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "05 Dec 2025 - 04 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "04 Dec 2025 - 03 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026", "03 Dec 2025 - 02 Jan 2026"], "download_control_visible": true, "matched_row_text_full": "05 Dec 2025 - 04 Jan 2026", "range_match_strategy": "date_range_text_pattern", "download_locator_strategy": "href_contains_order_reports", "container_locator_strategy": "heading_preferred_wrapper", "selected_row_state": "downloadable", "selection_source": "downloadable_row", "ts": "2026-01-04T12:31:32.295318+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Orders report download saved", "download_path": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/data/A817_td_orders_20251205_20260104.xlsx", "suggested_filename": "1247-fGGB36lHGC0ivdZY-iLHb.xlsx", "matched_range_text": "05 Dec 2025 - 04 Jan 2026", "expected_range_texts": ["Dec 5, 2025 - Jan 4, 2026", "05 Dec 2025 - 04 Jan 2026", "Dec 05, 2025 - Jan 04, 2026", "Dec 05 2025 - Jan 04 2026", "05 Dec 2025 - 4 Jan 2026", "Dec 05, 2025 - Jan 4, 2026", "Dec 05 2025 - Jan 4 2026", "5 Dec 2025 - 04 Jan 2026", "Dec 5, 2025 - Jan 04, 2026", "Dec 5 2025 - Jan 04 2026", "5 Dec 2025 - 4 Jan 2026", "Dec 5 2025 - Jan 4 2026"], "download_locator_strategy": "href_contains_order_reports", "range_match_strategy": "date_range_text_pattern", "container_locator_strategy": "heading_preferred_wrapper", "selected_row_state": "downloadable", "selection_source": "downloadable_row", "ts": "2026-01-04T12:31:32.758727+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "ingest", "status": "warn", "message": "TD Orders workbook ingested with warnings", "warnings": ["Invalid phone number dropped: A817--7461", "Invalid phone number dropped: 18409065"], "staging_rows": 251, "final_rows": 251, "ts": "2026-01-04T12:31:34.853371+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "iframe", "status": "ok", "message": "Orders iframe flow completed", "download_path": "/Users/wagidsheikh/Documents/programming/python/simplify_downloader/app/crm_downloader/data/A817_td_orders_20251205_20260104.xlsx", "ts": "2026-01-04T12:31:34.853480+00:00"}
{"run_id": "20260104_122748403746", "store_code": "A817", "phase": "store", "status": "ok", "message": "Completed TD orders store discovery", "session_reused": true, "ts": "2026-01-04T12:31:34.853546+00:00"}
{"run_id": "20260104_122748403746", "phase": "notifications", "status": "ok", "message": "TD orders sync discovery flow complete; notifying", "run_env": "dev", "ts": "2026-01-04T12:31:35.531905+00:00"}
{"run_id": "20260104_122748403746", "phase": "run_summary", "status": "ok", "message": "Run summary inserted", "overall_status": "warning", "ts": "2026-01-04T12:31:35.594588+00:00"}
wagidsheikh@Wagids-MacBook-Pro simplify_downloader % 